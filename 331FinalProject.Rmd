---
title: "STAT 331 Final Project"
author: "Maxine, Estella, Judy, Weiwei"
date: "04/12/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# Requirement of the project 
Your 7â€“10 page report must contain the following components: 

- 1. Summary:
A maximum of 200 words describing the objective of the report, an overview of the statistical analysis, and summary of the main results.

- 2. Objective:
Describe your goals for the analysis.

- 3. Exploratory Data Analysis:
Conduct exploratory data analyses: report summary statistics, visualize data (histograms, scatter plots, etc.). Report on any interesting findings and comment on how these inform the rest of your analysis.

- 4. Methods:
Describe your statistical analysis: What is your model? Did you use any transformations or extensions of the basic multiple linear regression model? How did you select a model? Does the model fit the data well? Are the necessary assumptions met? Be sure to explain and justify your decisions.

- 5. Results:
Report on the findings of your analysis

- 6. Discussion:
Comment on your findings/conclusions; describe any limitations of your analysis.


# 1. Summary
A maximum of 200 words describing the objective of the report, an overview of the statistical analysis, and summary of the main results.

# 2. Objective 

The goal of this project is to analyze the pollutants.csv data and write a report on your analysis. The specific goals of your analysis are up to you to decide.

# 3. Exploratory Data Analysis
Conduct exploratory data analyses: report summary statistics, visualize data (histograms, scatter plots, etc.). Report on any interesting findings and comment on how these inform the rest of your analysis.

can use this as a tutorial https://r4ds.had.co.nz/exploratory-data-analysis.html


Take a peak at the first 5 entries
```{r pollutants}
# CHANGE ABSOLUTE PATH
# setwd("~/Desktop/stat341/R331project/data")
# setwd("~/School/4A/STAT 331/R331project/data")
# setwd("~/Desktop/R331project/data")

pollutants <- read.csv("pollutants.csv", header = TRUE)
head(pollutants)
```

## Covariates
```{r covariates}
names(pollutants)
```
Note that "edu_cat", "race_cat", "male", "smokenow" are categorical data. 

```{r histograms}
# 1 = Less Than 9th Grade or 9-11th Grade (Includes 12th grade with no diploma) 
# 2 = High School Grad/GED or Equivalent
# 3 = Some College or AA degree
# 4 = College Graduate

edu_factor=as.factor(pollutants$edu_cat)
plot(edu_factor, 
     main="Distribution of Education",
     xlab="Education Level")

# 1 = Other Race (Including Multi-Racial);
# 2 = Mexican American; 
# 3 = Non-Hispanic Black; 
# 4 = Non-Hispanic White

race_factor=as.factor(pollutants$race_cat)
plot(race_factor, 
     main="Distribution of Race",
     xlab="Race Level")
```


```{r correlations}
# Estella's work 1
library(corrplot)
library(ggplot2)

summary(pollutants)
POP_PCB = c("POP_PCB1", "POP_PCB2","POP_PCB3", "POP_PCB4","POP_PCB5", "POP_PCB6","POP_PCB7", "POP_PCB8","POP_PCB9", "POP_PCB10", "POP_PCB11")
POP_PCB_data <- pollutants [, POP_PCB]
cc = cor(POP_PCB_data , method = "spearman")

# cluster my POP_PCB so that those with similar patterns of correlation coefficients are closer together. 
corrplot(cc, tl.col = "black", order = "hclust", hclust.method = "average", addrect = 4, tl.cex = 0.7)
#https://jkzorz.github.io/2019/06/11/Correlation-heatmaps.html
```

```{r interactions}
# Estella's work 3
f <- as.formula((paste("length", paste("(", paste(POP_PCB, collapse = " + "), ")^2"), sep = " ~")))
m <- lm(f, data = pollutants)
summary(m)
```

```{r}
# Judy's work Part 1
# testing non-linearity in SLR
# if for any covariate, residual vs x for M1 has a pattern and
# residual vs x for M2 seems random, then y has a nonlinear
# relationship with with x.
# M1: fitting y to x
# M2: fitting y to x^2
par(mfrow=c(1, 3))
outcome <- pollutants$length
check <- function(x) {
  M1 <- lm(outcome ~ x)
  print(paste("residual for M1: ", sigma(M1)))
  M2 <- lm(outcome ~ x + I(x^2))
  print(paste("residual for M2: ", sigma(M2)))
  plot(x, M1$residual)
  plot(x, M2$residual)
  plot(x, outcome)
}
list <- list(pollutants$ageyrs, pollutants$yrssmoke,
             pollutants$BMI, pollutants$ln_lbxcot,
             pollutants$whitecell_count, pollutants$lymphocyte_pct, 
             pollutants$monocyte_pct, pollutants$eosinophils_pct, 
             pollutants$basophils_pct, pollutants$neutrophils_pct)
for (column in list) {
  check(column)
}
  
```

```{r}
# Judy's work Part 2
# testing non-linearity in MLR
library(car)
M <- lm (length ~ ., data=pollutants)
avPlots(M)
```
