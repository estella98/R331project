---
title: "STAT 331 Final Project"
author: "Maxine, Estella, Judy, Weiwei"
date: "04/12/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# Requirement of the project 
Your 7â€“10 page report must contain the following components: 

- 1. Summary:
A maximum of 200 words describing the objective of the report, an overview of the statistical analysis, and summary of the main results.

- 2. Objective:
Describe your goals for the analysis.

- 3. Exploratory Data Analysis:
Conduct exploratory data analyses: report summary statistics, visualize data (histograms, scatter plots, etc.). Report on any interesting findings and comment on how these inform the rest of your analysis.

- 4. Methods:
Describe your statistical analysis: What is your model? Did you use any transformations or extensions of the basic multiple linear regression model? How did you select a model? Does the model fit the data well? Are the necessary assumptions met? Be sure to explain and justify your decisions.

- 5. Results:
Report on the findings of your analysis

- 6. Discussion:
Comment on your findings/conclusions; describe any limitations of your analysis.


# 1. Summary
A maximum of 200 words describing the objective of the report, an overview of the statistical analysis, and summary of the main results.

# 2. Objective 

The goal of this project is to analyze the pollutants.csv data and write a report on your analysis. The specific goals of your analysis are up to you to decide.

# 3. Exploratory Data Analysis
Conduct exploratory data analyses: report summary statistics, visualize data (histograms, scatter plots, etc.). Report on any interesting findings and comment on how these inform the rest of your analysis.

can use this as a tutorial https://r4ds.had.co.nz/exploratory-data-analysis.html


Take a peak at the first 5 entries
```{r pollutants}
# CHANGE ABSOLUTE PATH
setwd("~/Desktop/stat341/R331project/data")
# setwd("~/School/4A/STAT 331/R331project/data")

pollutants <- read.csv("pollutants.csv", header = TRUE)
head(pollutants)
```

## Covariates
```{r covariates}
names(pollutants)
```
Note that "edu_cat", "race_cat", "male", "smokenow" are categorical data. 

```{r histograms}
# 1 = Less Than 9th Grade or 9-11th Grade (Includes 12th grade with no diploma) 
# 2 = High School Grad/GED or Equivalent
# 3 = Some College or AA degree
# 4 = College Graduate

edu_factor=as.factor(pollutants$edu_cat)
plot(edu_factor, 
     main="Distribution of Education",
     xlab="Education Level")

# 1 = Other Race (Including Multi-Racial);
# 2 = Mexican American; 
# 3 = Non-Hispanic Black; 
# 4 = Non-Hispanic White

race_factor=as.factor(pollutants$race_cat)
plot(race_factor, 
     main="Distribution of Race",
     xlab="Race Level")
```


```{r correlations}
# Estella's work 1
library(corrplot)
library(ggplot2)

summary(pollutants)
POP_PCB = c("POP_PCB1", "POP_PCB2","POP_PCB3", "POP_PCB4","POP_PCB5", "POP_PCB6","POP_PCB7", "POP_PCB8","POP_PCB9", "POP_PCB10", "POP_PCB11")
POP_PCB_data <- pollutants [, POP_PCB]
cc = cor(POP_PCB_data , method = "spearman")

# cluster my POP_PCB so that those with similar patterns of correlation coefficients are closer together. 
corrplot(cc, tl.col = "black", order = "hclust", hclust.method = "average", addrect = 4, tl.cex = 0.7)
#https://jkzorz.github.io/2019/06/11/Correlation-heatmaps.html
```

```{r interactions}
# Estella's work 3
f <- as.formula((paste("length", paste("(", paste(POP_PCB, collapse = " + "), ")^2"), sep = " ~")))
m <- lm(f, data = pollutants)
summary(m)
```

```{r interactions}
#stepwise parameters selection without any interaction terms
M0 <- lm(length ~ 1, data = pollutants) # minimal model
Mfull <- lm(length ~ .,
            data= pollutants )

df.penalty <- 2 # this is the k penalty

## 2 corresponds to AIC
## log(n) corresponds to BIC

# stepwise AIC
Mstart <- lm(length ~ .,
            data= pollutants )
system.time({
  Mstep_AIC <- step(object = Mstart,
                scope = list(lower = M0, upper = Mfull),
                direction = "both", trace = 0, k = 2)
})

#stepwiseBIC
system.time({
  Mstep_BIC <- step(object = Mstart,
                scope = list(lower = M0, upper = Mfull),
                direction = "both", trace = 0, k = log(nrow(pollutants)))
})

#stepwiseB_Adjusted R2
Mstep_AIC
Mstep_BIC
```